version: 2
plan:
  project-key: WCAB
  key: CAR
  name: car-build
stages:
- Build CAR Appication:
    manual: false
    final: false
    jobs:
    - Build CAR File
Build CAR File:
  key: JOB1
  tasks:
  - checkout:
      force-clean-build: false
      description: clone project
  - script:
      interpreter: SHELL
      scripts:
      - 'mvn clean install -Dmaven.test.skip=true'
  # - script:
  #     interpreter: SHELL
  #     scripts:
  #     - 'mvn deploy:deploy-file -Durl=http://localhost:8081/repository/wso2-snapshot-artifacts -DrepositoryId=wso2-snapshot-artifacts -Dfile=HostReferenceProjectCompositeExporter/target -DgroupId=com.wso2.reference -DartifactId=HostReferenceProject -Dversion=1.0.0 -Dpackaging=pom'
  - script:
      interpreter: SHELL
      scripts:
      - 'curl -v -u admin:admin@123 --upload-file HostReferenceProjectCompositeExporter/target http://localhost:8081/repository/wso2-snapshot-artifacts/com.wso2.reference/HostReferenceProject/1.0.0-SNAPSHOT/HostReferenceProjectCompositeExporter_1.0.0-SNAPSHOT.car'
  # - maven:
  #     executable: Maven 3
  #     jdk: JDK 11
  #     goals: deploy
  #     serverId: Nexus
  #     pom: pom.xml
  #     repositoryId: wso2-snapshot-artifacts
  #     url: http://localhost:8081/repository
  #     authentication:
  #       username: admin
  #       password: admin@123
  # - maven:
  #     executable: Maven 3
  #     jdk: JDK 11
  #     goal: deploy -DaltDeploymentRepository=nexus-snapshot-repo::default::http://localhost:8081/repository/wso2-snapshot-artifacts
  #     description: Deploy artifacts into Nexus
  # - maven:
  #     executable: Maven 3
  #     jdk: JDK 11
  #     goal: clean install -U deploy -DaltDeploymentRepository=nexus-snapshot-repo::default::http://localhost:8081/repository/wso2-snapshot-artifacts
  #     tests: 'true'
  #     description: Deploy to nexus
  artifacts:
  - name: CApp
    location: HostReferenceProjectCompositeExporter/target
    pattern: '*.car'
    shared: true
    required: true
  artifact-subscriptions: []
repositories:
- HostReferenceProject:
    type: git
    url: https://github.com/prasangab/hostreferenceproject
    branch: develop
    command-timeout-minutes: '180'
    lfs: false
    verbose-logs: false
    use-shallow-clones: false
    cache-on-agents: true
    submodules: false
    ssh-key-applies-to-submodules: true
    fetch-all: false
triggers: []
branches:
  create: manually
  delete: never
  link-to-jira: true
notifications: []
labels: []
dependencies:
  require-all-stages-passing: false
  enabled-for-branches: true
  block-strategy: none
  plans: []
other:
  concurrent-build-plugin: system-default